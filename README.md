# shopify_commission_app

Pre-request:
Rails > 5.1.4 (This git project is using 6.0.3.2)  
Ruby > 2.4.1 (This git project is using 2.6.6)  
Node.js  
XAMPP (Apache + MySQL)  

Optional pre-request:
Heroku (Cloud Application Platform) (https://www.heroku.com/)
Ngrok (https://ngrok.com/)

^^ If you have a domain with SSL (https), you do not need to install optional pre-request  

The shopify app is almost the same as https://github.com/Shopify/shopify_app#introduction  

--------------------

"\shopify_app_with_scripttags\config\initializers\shopify_app.rb"
"nodejs shopify\demo_db_connection.js"
"htdocs\script_tags.js"

These are the three files you may need to configure. They are all about domain name/database connection. You can depend on your need and configure them.

--------------------

Installation guide:

1. Install Heroku and Ngrok

2. Install XAMPP and start Apache and MySQL.

3. Put script_tag.js ("htdocs\script_tags.js") to your htdocs in XAMPP.

4. Then, run ngrok and enter "ngrok http 80". It will generate a link with https that link forwards request to your localhost.

5. Next, follow youtube tutorial.

https://www.youtube.com/watch?v=yGxeoAHlQOg
Here is a youtube tutorial about how to build the app with Heroku.  
Follow it until 3:00

After running command "rails generate shopify_app --api_key [YOUR_API_KEY] --secret_key [YOUR_SECRET_KEY]", go to "\shopify_app_with_scripttags\config\initializers\shopify_app.rb" and edit

```
ShopifyApp.configure do |config|
  config.scripttags = [
    {event:'onload', src: 'https://my-shopifyapp.herokuapp.com/fancy.js'},
    {event:'onload', src: ->(domain) { dynamic_tag_url(domain) } }
  ]
end

config.scope = '... , write_script_tags'
```

*The scr domain of the src is the link generated by Ngrok. For example: https://75f256df2b62.ngrok.io/script_tag.js*

6. Then, keep following the youtube tutorial.

7. After finishing the tutorial, go to Heroku -> your app -> settings -> Reveal Config Vars.  
Add SHOPIFY_API_KEY as key, your api key as value.  
Add SHOPIFY_API_SECRET as key, your secret key as value.  

![image](https://github.com/Nero9Chan/shopify_commission_app/blob/master/readme_image/git1.png)  
![image](https://github.com/Nero9Chan/shopify_commission_app/blob/master/readme_image/git2.png)  

8. Next, import database to Mysql. (Just simply run all sql in mysql "database\shopify.sql")

9. You can configure the setting of database connection in "nodejs shopify\demo_db_connection.js".

10. Finally, launch nodejs "shopify/server.js"

---------------------

Please note that all the links need to be https or localhost. If you have a domain with SSL (for Node.js), configure the link in script_tag.js

After installation of the things above, you can enter https://www.yourshopifylink.myshopify.com/?user1 to confirm whether the database updates or not.
